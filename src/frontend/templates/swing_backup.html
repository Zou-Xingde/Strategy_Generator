<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Swing Generator - Ê≥¢ÊÆµÁîüÊàêÂô®</title>
    <link rel="stylesheet" href="/static/swing.css?v={{ cache_buster }}">
    <script src="https://unpkg.com/lightweight-charts@3.8.0/dist/lightweight-charts.standalone.production.js"></script>
</head>
<body class="market-swing-theme">
    <!-- ÈüøÊáâÂºè‰∏ªÂÆπÂô® -->
    <div class="app-container">
        <!-- È†ÇÈÉ®Â∑•ÂÖ∑Ê¨Ñ -->
        <header class="main-toolbar">
            <!-- Â∑¶ÂÅ¥ÊéßÂà∂ÂçÄ -->
            <div class="toolbar-left">
                <!-- ÂìÅÁ®ÆÈÅ∏Êìá‰∏ãÊãâÈÅ∏ÂñÆ -->
                <div class="control-group symbol-group">
                    <div class="symbol-selector">
                        <button class="symbol-btn" id="symbol-dropdown">
                            <span id="current-symbol">XAUUSD</span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </button>
                        <div class="symbol-dropdown" id="symbol-dropdown-menu">
                            <div class="symbol-option" data-symbol="XAUUSD">XAUUSD (ÈªÉÈáë)</div>
                            <div class="symbol-option" data-symbol="US30">US30 (ÈÅìÁìäÊñØ)</div>
                            <div class="symbol-option" data-symbol="US100">US100 (Á¥çÊñØÈÅîÂÖã)</div>
                        </div>
                    </div>
                </div>
                
                <!-- ÊºîÁÆóÊ≥ïÈÅ∏Êìá -->
                <div class="control-group algorithm-group">
                    <div class="algorithm-selector">
                        <button class="algorithm-btn" id="algorithm-dropdown">
                            <span id="current-algorithm">ZigZag</span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </button>
                        <div class="algorithm-dropdown" id="algorithm-dropdown-menu">
                            <div class="algorithm-option" data-algorithm="ZigZag">ZigZag</div>
                            <div class="algorithm-option" data-algorithm="Swing High/Low">Swing High/Low</div>
                        </div>
                    </div>
                </div>
                
                <!-- ÂèÉÊï∏Ë®≠ÁΩÆÊåâÈàï -->
                <div class="control-group params-group">
                    <button class="tool-btn params-btn" id="swing-params" title="ÂèÉÊï∏Ë®≠ÁΩÆ">
                        <span class="btn-icon">‚öôÔ∏è</span>
                        <span class="btn-text">ÂèÉÊï∏</span>
                    </button>
                </div>
            </div>
            
            <!-- ‰∏≠ÈñìÊôÇÈñìÊ°ÜÊû∂ÂçÄ -->
            <div class="toolbar-center">
                <div class="timeframe-container">
                    <div class="timeframe-buttons">
                        <button class="tf-btn" data-timeframe="M1">M1</button>
                        <button class="tf-btn" data-timeframe="M5">M5</button>
                        <button class="tf-btn" data-timeframe="M15">M15</button>
                        <button class="tf-btn" data-timeframe="M30">M30</button>
                        <button class="tf-btn" data-timeframe="H1">H1</button>
                        <button class="tf-btn" data-timeframe="H4">H4</button>
                        <button class="tf-btn active" data-timeframe="D1">D1</button>
                        <button class="tf-btn" data-timeframe="W1">W1</button>
                        <button class="tf-btn" data-timeframe="MN">MN</button>
                    </div>
                </div>
            </div>
            
            <!-- Âè≥ÂÅ¥Â∑•ÂÖ∑ÂçÄ -->
            <div class="toolbar-right">
                <!-- Êó•ÊúüÁØÑÂúçÈÅ∏ÊìáÂô® -->
                <div class="control-group date-group">
                    <div class="date-range-selector">
                        <div class="date-input-group">
                            <label for="start-date">ÈñãÂßã</label>
                            <input type="date" id="start-date" class="date-input">
                        </div>
                        <div class="date-input-group">
                            <label for="end-date">ÁµêÊùü</label>
                            <input type="date" id="end-date" class="date-input">
                        </div>
                    </div>
                </div>
                
                <!-- Êìç‰ΩúÊåâÈàïÁµÑ -->
                <div class="control-group action-group">
                    <button class="action-btn primary-btn" id="generate-swing">
                        <span class="btn-icon">üîÑ</span>
                        <span class="btn-text">ÁîüÊàêÊ≥¢ÊÆµ</span>
                    </button>
                    <button class="action-btn secondary-btn" id="clear-swing">
                        <span class="btn-icon">üóëÔ∏è</span>
                        <span class="btn-text">Ê∏ÖÈô§</span>
                    </button>
                </div>
            </div>
            
            <!-- ÁßªÂãïÁ´ØÊº¢Â†°ÈÅ∏ÂñÆ -->
            <div class="mobile-menu-toggle">
                <button class="hamburger-btn" id="mobile-menu-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </header>
        
        <!-- ‰∏ªË¶ÅÂÖßÂÆπÂçÄÂüü -->
        <main class="main-content">
            <!-- ÂúñË°®ÂÆπÂô® -->
            <div class="chart-section">
                <div class="chart-container">
                    <div id="chart" class="trading-chart"></div>
                </div>
            </div>
        </main>
        
        <!-- Â∫ïÈÉ®ÁãÄÊÖãÊ¨Ñ -->
        <footer class="status-bar">
            <div class="status-left">
                <span id="connection-status" class="status-indicator">üü¢ Â∑≤ÈÄ£Êé•</span>
            </div>
            <div class="status-center">
                <span id="current-time" class="current-time"></span>
            </div>
            <div class="status-right">
                <span id="data-count">Êï∏ÊìöÈáè: -</span>
                <span class="separator">|</span>
                <span id="generation-status">Â∞±Á∑í</span>
            </div>
        </footer>
    </div>
                <button class="tool-btn" id="clear-dates" title="Ê∏ÖÈô§Êó•Êúü">üóëÔ∏è</button>
            </div>
        </div>
        
        <div class="toolbar-section">
            <!-- ÊºîÁÆóÊ≥ïÈÅ∏Êìá‰∏ãÊãâÈÅ∏ÂñÆ -->
            <div class="algorithm-selector">
                <button class="algorithm-btn" id="algorithm-dropdown">
                    <span id="current-algorithm">ZigZag</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </button>
                <div class="algorithm-dropdown" id="algorithm-dropdown-menu">
                    <div class="algorithm-option" data-algorithm="zigzag">ZigZag ÊºîÁÆóÊ≥ï</div>
                    <div class="algorithm-option" data-algorithm="fractal">Fractal ÊºîÁÆóÊ≥ï</div>
                    <div class="algorithm-option" data-algorithm="pivot">Pivot ÊºîÁÆóÊ≥ï</div>
                </div>
            </div>
            
            <div class="separator"></div>
            
            <button class="tool-btn" id="generate-swing" title="ÁîüÊàêÊ≥¢ÊÆµ">üöÄ</button>
            <button class="tool-btn" id="swing-params" title="ÂèÉÊï∏Ë®≠ÁΩÆ">‚öôÔ∏è</button>
            <button class="tool-btn" id="show-swing" title="È°ØÁ§∫Ê≥¢ÊÆµ">üìà</button>
            <button class="tool-btn" id="clear-swing" title="Ê∏ÖÈô§Ê≥¢ÊÆµ">üóëÔ∏è</button>
            <button class="tool-btn" id="swing-list" title="Ê≥¢ÊÆµÂàóË°®">üìã</button>

            
            <div class="separator"></div>
            
            <button class="tool-btn" id="zoom-in" title="ÊîæÂ§ß">+</button>
            <button class="tool-btn" id="zoom-out" title="Á∏ÆÂ∞è">-</button>
            <button class="tool-btn" id="zoom-reset" title="ÈáçÁΩÆÁ∏ÆÊîæ">üîÑ</button>
            <div class="separator"></div>
            <button class="tool-btn" id="crosshair" title="ÂçÅÂ≠óÁ∑ö">‚úö</button>
            <button class="tool-btn" id="measure" title="Ê∏¨ÈáèÂ∑•ÂÖ∑">üìè</button>
            <div class="separator"></div>
            <button class="tool-btn" id="fullscreen" title="ÂÖ®Â±è">‚õ∂</button>
        </div>
    </div>

    <!-- ÁîüÊàêÁãÄÊÖãÂçÄÂüü -->
    <div class="swing-status-area">
        <div id="swing-progress" class="swing-progress" style="display: none;">
            <div class="swing-progress-track">
                <div id="swing-progress-fill" class="swing-progress-fill"></div>
            </div>
            <span id="swing-progress-text" class="swing-progress-text">0%</span>
        </div>
        <pre id="swing-log" class="swing-log" style="display: none;"></pre>
    </div>

    <!-- ‰∏ªË¶ÅÂÖßÂÆπÂçÄÂüü -->
    <div class="main-content">
        <!-- ÂúñË°®ÂçÄÂüü -->
        <div class="chart-area">
            <!-- ÂúñË°®Ê®ôÈ°åÊ¨Ñ -->
            <div class="chart-header">
                <span class="chart-title" id="chart-title">XAUUSD, D1</span>
                <div class="chart-info">
                    <span id="price-info">ÂÉπÊ†º: -</span>
                    <span class="separator">|</span>
                    <span id="time-info">-</span>
                </div>
            </div>
            
            <!-- ‰∏ªÂúñË°®ÂÆπÂô® -->
            <div class="main-chart-container">
                <div id="main-chart"></div>
            </div>
        </div>
    </div>

    <!-- Ê∏¨ÈáèÁµêÊûúÊá∏ÊµÆË¶ñÁ™ó -->
    <div id="measurement-popup" class="measurement-popup" style="display: none;">
        <div class="measurement-header">
            <span class="measurement-title">üìè Ê∏¨ÈáèÁµêÊûú</span>
            <button class="measurement-close" onclick="closeMeasurementPopup()">√ó</button>
        </div>
        <div class="measurement-content">
            <div class="measurement-item">
                <span class="measurement-label">ÂÉπÊ†ºÂ∑Æ:</span>
                <span id="measurement-price-diff" class="measurement-value">0.00</span>
            </div>
            <div class="measurement-item">
                <span class="measurement-label">ËÆäÂåñÁéá:</span>
                <span id="measurement-change-percent" class="measurement-value">0.00%</span>
            </div>
            <div class="measurement-item">
                <span class="measurement-label">ÊôÇÈñìÂ∑Æ:</span>
                <span id="measurement-time-diff" class="measurement-value">0Â∞èÊôÇ</span>
            </div>
            <div class="measurement-item">
                <span class="measurement-label">ÊñπÂêë:</span>
                <span id="measurement-direction" class="measurement-value">-</span>
            </div>
        </div>
        <div class="measurement-actions">
            <button class="measurement-btn measurement-btn-clear" onclick="clearMeasurementAndClose()">Ê∏ÖÈô§Ê∏¨Èáè</button>
            <button class="measurement-btn measurement-btn-keep" onclick="keepMeasurementAndClose()">‰øùÁïôÊ∏¨Èáè</button>
        </div>
    </div>

    <!-- ÂèÉÊï∏Ë®≠ÁΩÆÂΩàÂá∫Ë¶ñÁ™ó -->
    <div id="params-popup" class="params-popup" style="display: none;">
        <div class="params-header">
            <span class="params-title">‚öôÔ∏è ÂèÉÊï∏Ë®≠ÁΩÆ</span>
            <button class="params-close" onclick="closeParamsPopup()">√ó</button>
        </div>
        <div class="params-content">
            <div id="params-form">
                <!-- ÂèÉÊï∏Â∞áÂú®ÈÄôË£°ÂãïÊÖãÁîüÊàê -->
            </div>
        </div>
        <div class="params-actions">
            <button class="params-btn params-btn-cancel" onclick="closeParamsPopup()">ÂèñÊ∂à</button>
            <button class="params-btn params-btn-confirm" onclick="confirmParams()">Á¢∫Ë™ç</button>
        </div>
    </div>

    <!-- Ê≥¢ÊÆµÂàóË°®Êá∏ÊµÆË¶ñÁ™ó -->
    <div id="swing-list-popup" class="swing-list-popup" style="display: none;">
        <div class="swing-list-header">
            <span class="swing-list-title">üìã Ê≥¢ÊÆµÂàóË°®</span>
            <button class="swing-list-close" onclick="closeSwingListPopup()">√ó</button>
        </div>
        <div class="swing-list-content">
            <div class="swing-list-table">
                <div class="swing-list-row swing-list-header-row">
                    <div class="swing-list-cell">ÈñãÂßãÊôÇÈñì</div>
                    <div class="swing-list-cell">ÈñãÂßãÂÉπÊ†º</div>
                    <div class="swing-list-cell">ÁµêÊùüÊôÇÈñì</div>
                    <div class="swing-list-cell">ÁµêÊùüÂÉπÊ†º</div>
                    <div class="swing-list-cell">ÂÉπÂ∑Æ</div>
                    <div class="swing-list-cell">ÊôÇÂ∑Æ</div>
                </div>
                <div id="swing-list-body">
                    <!-- Ê≥¢ÊÆµÂàóË°®ÂÖßÂÆπÂ∞áÂú®ÈÄôË£°ÂãïÊÖãÁîüÊàê -->
                </div>
            </div>
        </div>
    </div>

    <!-- Â∫ïÈÉ®ÁãÄÊÖãÊ¨Ñ -->
    <div class="status-bar">
        <div class="status-left">
            <span id="connection-status">Â∑≤ÈÄ£Êé•</span>
            <span class="separator">|</span>
            <span id="current-time">-</span>
        </div>
        <div class="status-right">
            <span id="data-count">Êï∏ÊìöÈáè: -</span>
            <span class="separator">|</span>
            <span id="generation-status">Â∞±Á∑í</span>
        </div>
    </div>

    <script src="/static/swing.js?v={{ cache_buster }}"></script>
</body>
</html>
